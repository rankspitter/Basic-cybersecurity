
# Module 5 Cryptography


# นิยามสำคัญ (Key terminologies)

Plain Text 
	ข้อความปกติที่ต้องการส่งไปยังผู้รับ สามารถอ่านและเข้าใจได้โดยตรง สามารถเรียกแบบได้ว่า Clear Text

Cipher Text
	ข้อความที่เข้ารหัสจาก Plain Text
Encryption
	กระบวนการเข้ารหัส เมื่อทำกับ Plain Text จะได้ Cipher Text ตามสมการ
	 C = E(P)
Decryption
	กระบวนการถอดรหัส เมื่อทำกับ Cipher Text จะได้ Plain Text ตามสมการ
		P = D (C)


นิยามของวิทยการระบบรหัส
Cryptography หรือ การเข้ารหัส มาจากคำภาษากรีก kryptos  หมายถึง การปกกิด graphia แปลว่า การเขียน
Cryptography จึงหมายถึง ศิลปะแห่ง การเขียนที่เป็นความลับ 

วิทยาการเข้ารหัสลับ (cryptography)
คือ กระบวนการปกปิดข้อมูลโดยการแปลง plain text ไปเป็น cipher text โดยใช้ key ร่วมกับ encryption scheme เพื่อปกปิดข้อมูลที่เป็นความลับ

การถอดรหัสโดยปราศจากกุญแจ (cryptanalysis)
เป็นการถอดรหัส โดยใช้วิธีการหาจุดอ่อน ในกระบวนการเข้ารหัส จนสามารถถอดรหัสได้โดยไม่ต้องมี key 
ปัจจุบันการเข้ารหัสสมัยใหม่ ใช้วิธีนี้ไม่ค่อยได้เนื่องจาก มีกลไกที่แข็งแรงกว่าเมื่อก่อน

เป้าหมายของวิทยาการเข้ารหัสลับ
- Confidentiality ใช้เพื่อรับประกันว่าผู้ที่ได้รับอนุญาติเท่านั้น ถึงจะเข้าถึงข้อมูลได้
- integrity ใช้ป้องกันการเปลี่ยนแปลงข้อมูล 
- Authentication ใช้การพิสูจน์ตัวตน พิสูจน์ความถูกต้อง
- Non-repudition ใช้เพื่อรับประกันว่า ผู้ข้อความ ไม่สามารถปฏิเสฑการส่งข้อความภายหลังได้ ผู้รับก็เช่นกัน

แบบแผนการเข้ารหัส (cryptography scheme)
เป็นการนำ plain text มาผ่าน algorithm เข้ารหัส เช่น RSA,MD5, SHA, AES จะได้รูปแบบ Cipher Text 
เมื่อไปถึงปลายทางแล้ว ผู้รับสามารถใช้ algorithm ถอดรหัส จนได้ plaintext 

ประเภทของการเข้ารหัส (type of cryptography)
มี 2 แบบ
1. แบบสมมาตร (Symmetric Algorithm)
2. แบบอสมาตร (Asymmetric Algorithm)


การเข้ารหัสแบบสมมาตร (Symmetric Algorithm)
คือ ผู้ส่งและรับ จะต้องมี key ที่ใช้ในการเข้ารหัส อันเดียวกัน โดยผู้ส่งจะใช้ key เพื่อเข้ารหัส ผู้รับจะใช้ key เดียวกับผู้ส่งนั้นในการถอดรหัสเช่นกัน โดยเราจะเรียกวิธีการนี้ว่า วิทยาการเข้ารหัสลับแบบใช้กุญแจลับ(secret key cryptography)  การเข้ารหัสด้วยวิธีนี้จะใช้ได้ดีต่อเมื่อ ต้องการสื่อสารกับคนจำนวนน้อยๆเท่านั้น เทคนิคนี้จึงมีข้อจำกัด ในการใช้งาน internet ที่มี คนไม่รู้จักมาติดต่อ เราสามารถสื่อสารได้อย่างปลอดภัย โดยการใช้ วิทยาการเข้ารหัสลับแบบใช้กุญแจสาธารณะ (public-key cryptography)

การเข้ารหัสแบบอสมมาตร ( Asymmetric encryption)
เป็นแนวคิดในการแก้ปัญหา การจัดการ secret key โดยกำหนดให้มี key คู่ ที่ประกอบด้วย private key ผู้ส่งต้องเก็บไว้เป็นความลับ และ  public key สามารถเผยแพร่ได้

ระบบการเข้ารหัสอสมมาตรนี้ จะสามารถรักษาความปลอดภัยได้ดีตามที่เจ้าของ key นั้น รักษา private key ได้ โดยมีลำดับการส่งข้อความดังนี้
1.  ผู้ส่งหา public key ของคนที่ต้องการติดต่อใน directory
2. ใช้ public key นั้น เพื่อเข้ารหัสแล้วส่งข้อความไปยังผู้รับ
3. ผู้รับใช้ private key เพื่อถอดรหัส 

กลไกของระบบกุญแจคู่นี้ มีเพียงกุญแจเดียวก็สามารถถอด public key ที่สัมพันธ์กันได้ ดั้งนั้นผู้ใช้สามารถจัดการบริการกุญแจได้ง่ายๆ โดยเพียงแค่ต้องรักษา private key และส่ง public key ไปให้บุคคลอื่นที่ต้องการสื่อสารได้อย่างปลอดภัย


ประเภทของข้อความรหัสลับ (type of cipher )
มี 2 แบบ
1. รหัสแบบดั้งเดิม (Classical Cipher)
2. รหัสลับยุคใหม่ (Modern ciphers)

รหัสแบบดั้งเดิม (Classical Cipher)
เป็นรหัสลับแบบพื้นฐาน มักสร้างด้วยวิธีการง่ายๆ ปัจจุบันไม่ค่อยใช้กันเพราะ ถอดรหัสได้โดยไม่ต้องมี key 
แบ่งออกเป็น 2 กลุ่ม
 - รหัสลับแบบแทนที่ (Substitution cipher)
 - รหัสแบบเปลี่ยนตำแหน่ง(Transposition cipher)

รหัสลับแบบแทนที่ (Substitution cipher)
เป็นการใช้แทนที่ตัวอักษรแต่ละตัวของ plain text ด้วย cipher text โดยหน่วยของตัวอักษร อาจเป็นตัวเดี่ยว คู่ หรือ เป็นชุดก็ได้ ผู้รับต้องทำกระบวนการย้อนกลับ ตัวอย่างการเข้ารหัสแบบนี้ เช่น Beale cipher Autokey Cipher ,Gronsfeld Cipher ,Hil Cipher

รหัสแบบเปลี่ยนตำแหน่ง
ใช้การเรียงตำแหน่งของตัวอักษรต่างๆใน plain text ใหม่ 
ตัวอย่างการเข้ารหัสลับ เช่น Rail Fence Cipher , Route Cipher , Myszkowski Transposition


การเข้ารหัสแบบยุคใหม่ (Modern cipher)
เป็นการเข้ารหัส โดยใช้ฟังก์ชั่นทาง คณิตศาสตร์แบบทางเดียว (one-way mathmetical function) การแยกตัวประกอบ (factoring )  จำนวนเฉพาะ ( Prime number)
การเข้ารหัสแบบยุคใหม่ แบ่งได้ 2 กลุ่ม คือ
- แบ่งตาม algorithm ที่ใช้
- แบ่งตามชนิดข้อมูล input

แบ่งตาม algorithm ที่ใช้
-  แบบสมมาตร เป็นการใช้กุญแจเดียวกันในการเข้าและถอดรหัส
-  แบบอสมมาตร ใช้กุญแจคนละดอก ในการเข้าและถอดรหัส

แบ่งตามชนิดข้อมูล input
- รหัสแบบบล็อค (block ciphers) เป็นการใช้ algorithm แบบบล็อค (กลุ่มของบิต) ที่มีขนาดคงที่เสมอ สามารถใช้กุญแจแบบสมมาตร และ อสมมาตรก็ได้ เช่น DES, AES, IDEA
- รหัสแบบสตรีม (stream ciphers)  ใช้กุญแบบสมมาตรที่อยู่ในรูปแบบของ plain text ร่วมกับ กุญแจแบบสตีมที่เป็นตัวเลขแบบสุ่ม โดยผู้ใช้จะเข้ารหัสทีละบิต อย่างต่อเนื่อง เช่น RC4, SEAL 


Symmetric Algorithm หรือ Symmetric-Key / Private-Key Cryptography
เป็นการเข้ารหัส โดยใช้กุญแจเดียวกันในการเข้ารหัสและถอดรหัส จึงจำเป็นต้องมีการแลกเปลี่ยนกุญแจรหัสผ่านช่องทางที่ปลอดภัย


Advanced Encryption Standard (AES)
เป็นข้อกำหนดการเข้ารหัสของ NIST ใช้ในการเข้ารหัสข้อมูลการเงิน โทรคมนาคม ข้อมูลรัฐ เพื่อรักษาความปลอดภัยของข้อมูลที่ไม่ได้กำหนดชั้นความลับ
AES ประกอบด้วย algorithm แบบสมมาตรและอสมมาตร ทำการเข้ารหัสข้อมูลโดยการเปลี่ยนแปลงข้อมูลในบล็อคหลายๆรอบ โดยแต่ละรอบสถานะข้อมูลก็จะเปลี่ยนแปลงไปตามข้อกำหนดของกระบวนการ ขนาดของบล็อคกำหนดให้เป็น 129 บิต โดยใช้กุญแจขนาด 128 192 256 สำหรับ AES-128 AES-192 AES-256 ตามลำดับ

AES Pesudocode
![](Pasted%20image%2020240903165854.png)เริ่มจากระบบจะคัดลอก cipher input ไปยังสถานะภายใน แล้วเพิ่ม key จากนั้นก็จะเปลี่ยนสถานะโดยวนซ้ำหลายๆรอบ จำนวนรอบจะแตกต่างกันไป ขึ้นอยู่กับขนาดบล็อค และ ความยาวของกุญแจ เมื่อเสร็จสิ้น
วงรอบ ระบบจะคัลลอกสถานะสุดท้ายไปยัง cipher output


DES (Data Encryption Standard)
เป็นมาตรฐานการเข้ารหัสแบบสมมาตร การเข้ารหัสและถอดรหัสจะใช้กุญแจขนาด 64 บิต โดย 56 จะถูกส่มและอีก 8 บิต จะใช้ในการตรวจจับข้อผิดพลาด


RC Algorithm
ประกอบไปด้วย RC4, RC5, RC6

RC4
เป็นการเข้ารหัสลับแบบ stream cipher ที่ใช้กุญแจแบบอสมมาตร ขนาดกุญแจแปลี่ยนแปลงได้ 
ใช้การดำเนินการเชิงไบต์ (byte-oriented operation ทำทีละไบต์ ) ที่ใช้ในการสุ่ม

RC5
เป็นการเข้ารหัสแบบบล็อค (block cipher) ที่ใช้กุญแจแบบสมมาตร  Ronald Rivest เป็นผู้ออกแบบ เพื่อใช้สำหรับ DSA Data Security (RSA Security) ใช้ algorithm  ที่สามารถกำหนด พารามิเตอร์ให้เปลี่ยนแปลงขนาดของบล็อค ขนาดของกุญแจ และจำนวนรอบได้ โดย ขนาดอาจะเป็น 32 64 128 จำนวนรอบ 0 - 255 และขนาดของกุญแจ 0 - 2040 ชุดคำสั่งภายใน RC5 ประกอบไปด้วยการขยายกุญแจ การเข้ารหัส และ ถอดรหัส
สำหรับการขยายกุญแจ กุญแจจะถูกกำหนดให้ขยายจนเต็มกุญแจ (ขนาดอยู่ที่จำนวนรอบ) โดย RC5 จะใช้ตารางกุญแจในการเข้าและถอดรหัส สำหรับการเข้ารหัส จะมี 3 กระบวนการ
- การบวกจำนวนเต็ม
- Bitwise XOR
- Variable rotation

RC6 
คล้ายกับ RC5 ตรงที่เป็นการกำหนดพารามิเตอร์ ที่สามารถปรับขนาดบล็อค ขนาดคีย์ และจำนวนรอบได้ โดยมีคุณลักษณะ 2 ประการที่ทำให้ต่างจาก RC5 คือ การคุณจำนวนเต็มและการใช้ริจิสเตอร์ขนาด 4 บิต
จำนวน 4 ตัวแทนที่จะใช้ 2 บิจ จำนวน 2 ตัว เนื่องจากขนาดของบล็อค AES มีค่าเป็น 128


E-Signature
Digital Signature Algorithm หรือ DSA เป็นมาตรฐานการประมวลผลข้อมูลของรัฐบาลของอเมริกาที่ NIST  ได้เสนอ DSA เพื่อใช้ในมาตรฐาน Digital Signature Standard หรือ DSS ต่อมาได้ปรับเปลี่ยนเป็นมาตรฐาน FIPS 186 โดย DSA ได้ช่วยในการสร้างและตรวจสอบ Signature สำรหับแอปพลิเคชั้นที่ไม่จำกัดชั้นความลับ โดยจะสร้างSignature ขนาด 320 บิต แต่มีระดับความมั่นคงปลอดภัยขนาด 512-1024 บิต



กระบวนการที่เกี่ยวข้องกับ DSA 
- กระบวนการสร้างลายมือดิจิทัล: ลงนามโดยใช้ private key เพื่อให้ทราบว่าใครลงนาม
- กระบวนการตรวจสอบลายมือดิจิทัล: ใช้ public key เพื่อตรวจสอบว่าลายมือดิจิทัลที่ระบุนั้น เป็นของแท้หรือไม่

DSA เป็นระบบเข้ารหัสกุญแจสาธารณะ เนื่องจากเกี่ยวข้องกับการใช้ทั้ง public key private key โดยมีข้อดีดังนี้
- โอกาสปลอมแปลงน้อยกว่าการใช้การเซ็นแบบอักษร
- เป็นวิธีการทำธรุกรรมทางธรุกิจที่ง่ายและเร็ว
- ลดปัญหาการใช้ธนาบัตรปลอม


Rivest Shamir Adleman (RSA)
เป็นการเข้ารหัสแบบ public key ใช้ทฤษฏีในการหาเศษจากการหาร และ ทฤษฏีจำนวน เป็นพื้นฐานในการคำนวณโดยใช้จำนวนเฉพาะขนาดใหญ่ 2 จำนวน 

![](Pasted%20image%2020240903214330.png)


MD5
MD2, MD4, MD5 เป็น algorithm message-digest ที่ใข้ใน e-signature เพื่อบีบอัดเอกสารอย่างปลอดภัย ก่อนที่จะลงลายชื่อด้วย private key algorithm อาจทีความยาวเท่าไรก็ได้ แต่ผลที่ได้จากการทำ message-digest จะเป็น 128 บิตเสมอ
โครงสร้างของทั้ง 3 จะคล้ายกัน  MD2 รองรับเครื่อง 8 bit MD4,5 รองรับ 32 bit algorithmจะเพิ่มbitพิเศษลงไปในข้อความ เพื่อให้ความยาวbitหารด้วย 512 ลงตัว

SHA (Secure Hashing Algorithm)
NIST ได้พัฒนา SHA เป็นการสร้างฟังกขั่นแฮชแบบทางเดียวที่ปลอดภัยด้วยการเข้ารหัส โดย Rivest พัฒนา SHA ซึ่งคล้ายกับ algorithm ในตะกูล message-digest ของฟังกชั่นแฮช โดย SHA ทำงานช้ากว่า MD5 เล็กน้อย แต่ message-digest ที่ใหญ่กว่าทำให้ปลอดภัยมากขั้นจากการ brute-force และ การโจมตีย้อนกลับ
การเข้ารหัส SHA เป็นชุกฟังกชั่นเข้ารหัสที่แตกต่าวกัน 5 แบบ  ปัจจุบันมี 3 รุ่น : SHA1 SHA2 SHA3

SHA-1 
เป็นฟังกชั่น 160 บิตที่คล้ายกับ MD5 คือมันสร้าง message-digest 160 บิต จากข้อความที่มีความยาวสูงสุด (264-1) ออกแบบโดย National Security Agency (NSA) ให้เป็นส่วนหนึ่งของ DSA มักใช้ในโปรโตคอล PGP,TLS,SSH,SSl ปัจจุบันไม่นิยมใช้อีกต่อไปเนื่องจากมีจุดอ่อนในการเข้ารหัส

SHA-2 
เป็นตะกูลของฟังกชั่นแฮชที่คล้ายกัน 2 ฟังกชั่น โดยมีขนาดบล็อค ที่แตกต่างกันคือ SHA-256 ใช้ 32 bit และ SHA-512 ใช้ 64 bit version ย่อแต่ละมาตรฐานคือ SHA-224, SHA-384

SHA-3
ใช้โครงสร้างที่เป็นฟองน้้ำ ซึ่งชุดข้อความจะถูก XOR เป็นบิตเริ่มต้นของstate ซึ่ง algorithm จะถูกเรียงสลับกัน รองรับความยาวแฮชเช่นเดียวกันกับ SHA-2 แต่แตกต่างกันในโครงสร้างภายใสนอย่างมากจากตะกูล SHA อื่นๆ


ปัจจุบันไม่มีการใช้ SHA1 อีกต่อไปใช้ SHA2 เป็นมาตรฐานแทน

การรักษาความปลอดภัยการสื่อสาร SSH
ตรวจสอบสิทธิ์อย่างน้อยต่อไปนี้
- unix: /etc /passwd /etc/shadow
- public key RSA หรือ DSA ขึ้นอยู่กับ รีลีส
- Kerberos (SSH1)
- .rhost ,/etc/hosts. equiv

Public Key infrastructure: PKI
เป็นสถาปัตยกรรมความปลอดภัยที่พัฒนาขึ้นเพื่อเพิ่มความลับ ของข้อมูลที่แลกเปลี่ยนผ่านอินเทอร์เน็ตที่ไม่ปลอดภัย เป็นระบบครบวงจรที่อนุญาตให้ใช้การเข้ารหัส public key และ e-signature 


โปรโตคอลด้านความปลอดภัย (security protocol, cryptographic protoco,l encrypted protocol)
เป็นโปรโคคอลที่เกี่ยวข้องกับการรักษาความปลอดภัย โดยการประยุกต์ใช้วิทยาการเข้ารหัสลับ
โปรโตคอลด้านความปลอดภัย สำหรับการส่งข้อมูล มีหลายรูปแบบ เช่น
- SSL & TSL ใช้ในการรับส่งข้อมูลทั่วไป
- IPSEC เป็นโปรโตคอลเครือข่ายใช้ตรวจสอบ อัตลักษณ์ของระบบเครือข่าย และเข้ารหัส packet
- Kerberos เป็นตรวจสอบอัตลักษณ์ของระบบเครือข่าย
- HTTPS ใช้ในเว็บทั่วไป
- SSH FTPS

![](Pasted%20image%2020240903221856.png)

SSL 
เป็นโปรโตคอลมี่ใช้ในการจัดเตรียมกลไกการตรวจสอบความปลอดภัยระหว่างสอง application ที่สื่อสารกันเช่น client  sever  ต้องการโปรโตคอลการขนส่งที่เชื่อถือได้เช่น TCP สำหรับการส่งและรับข้อมูล

![](Pasted%20image%2020240903222602.png)

![](Pasted%20image%2020240903222647.png)![](Pasted%20image%2020240903222715.png)